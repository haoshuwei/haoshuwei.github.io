[{"author":null,"categories":["Tech"],"content":"本文主要阐述kube-apiserver kubelet在线调试方法","date":1692748800,"description":"本文主要阐述kube-apiserver kubelet在线调试方法","dir":"post/","excerpt_html":"本文主要阐述kube-apiserver kubelet在线调试方法","excerpt_text":"本文主要阐述kube-apiserver kubelet在线调试方法","expirydate":-62135596800,"fuzzywordcount":300,"html":"本文主要阐述kube-apiserver kubelet在线调试方法","keywords":null,"kind":"page","lang":"en","lastmod":1692748800,"objectID":"598336392427647069d96326e8d29b4f","permalink":"https://haoshuwei.github.io/post/2023-08-23-kubernetes-debug/","publishdate":"2023-08-23T00:00:00Z","readingtime":2,"relpermalink":"/post/2023-08-23-kubernetes-debug/","section":"post","summary":"本文主要阐述kube-apiserver kubelet在线调试方法。\n热更新 kubernetes 组件的日志级别 kube-apiserver/kubelet 等组件通常使用 -v 来设置日志级别，默认的日志级别是2，下面是动态热更新日志级别到4的操作步骤：\n# 使用 kube-apiserver 的 http 访问代理 $ kubctl proxy Starting to serve on [::]:8001 # 更新 kube-apiserver 组件的日志级别 $ curl -X PUT 127.0.0.1:8001/debug/flags/v -d \u0026#34;4\u0026#34; successfully set klog.logging.verbosity to 4 # 更新 kubelet 组件的日志级别 $ export NODENAME=hao $ curl -X PUT 127.0.0.1:8001/api/v1/nodes/${NODENAME=hao}/proxy/debug/flags/v -d \u0026#34;4\u0026#34; successfully set klog.logging.verbosity to 4 pprof 调试 pprof是google官方提供的golang 内存/CPU/goroutine 分析工具，主要用于性能分析。在 kubernetes 1.18+ 的版本中， kube-apiserver 已默认开启 pprof，参数如下所示：\n--profiling Enable profiling via web interface host:port/debug/pprof/ (default true) 开启 kube-apiserver 的 http 访问代理：","tags":["kubernetes"],"title":"kubernetes 组件debug调试","type":"post","url":"/post/2023-08-23-kubernetes-debug/","weight":0,"wordcount":274}]